import 'package:clean_code/Models/api_response.dart';
import 'package:clean_code/Screen/HomeScreen.dart';
import 'package:clean_code/Screen/ProfileScreen.dart';
import 'package:clean_code/Services/profile_service.dart';
import 'package:clean_code/models/notif_model.dart';
import 'package:flutter/material.dart';
import 'package:flutter/services.dart';
import 'package:get_it/get_it.dart';
import 'package:shared_preferences/shared_preferences.dart';

class Notification1Screen extends StatefulWidget {
  @override
  _Notification1ScreenState createState() => _Notification1ScreenState();
}

class _Notification1ScreenState extends State<Notification1Screen>
    with TickerProviderStateMixin {
  int _selectedIndex = 0;

  ProfileService get serviceProfile => GetIt.I<ProfileService>();
  APIResponse<List<NotifModel>>? _apiNotif;

  @override
  void initState() {
    _fetchAPI();
    super.initState();
  }

  _fetchAPI() async {
    // setState(() {
    //   _isLoading = true;
    // });
    _apiNotif = await serviceProfile.getNotif();
    print('cek notif');
    print(_apiNotif?.data[0].toString());
  }

  // List<String> notifications = [
  //   "Notification 1",
  //   "Notification 2",
  //   "Notification 3",
  //   // Add more notifications as needed
  // ];
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        leading: IconButton(
          icon: Icon(Icons.arrow_back, color: Color(0xFF3188FA)),
          onPressed: () => Navigator.of(context).pop(),
        ),
        centerTitle: true,
        title: Text(
          'Notification',
          style: TextStyle(color: Color(0xFF3188FA)),
        ),
        backgroundColor: Colors.white,
      ),
      body: SingleChildScrollView(
        child: Padding(
          padding: const EdgeInsets.all(16.0),
          child: Column(
            children: <Widget>[
              // ListView.builder for displaying notifications as cards
              ListView.builder(
                shrinkWrap: true,
                itemCount: _apiNotif?.data?.length ?? 0,
                itemBuilder: (BuildContext context, int index) {
                  return Card(
                    elevation: 3,
                    margin: EdgeInsets.symmetric(vertical: 8),
                    child: ListTile(
                      leading: Icon(
                        Icons.info_outline,
                        color: Colors.blue, // Change the color as needed
                      ),
                      title: Container(
                        child: Column(
                          children: [
                            Align(
                              alignment: Alignment.centerLeft,
                              child: Text(
                                  _apiNotif?.data?[index].description ?? '',
                                  style: TextStyle(fontSize: 12)),
                            ),
                            Align(
                              alignment: Alignment.centerLeft,
                              child: Text(_apiNotif?.data?[index].date ?? '',
                                  style: TextStyle(fontSize: 12)),
                            ),
                          ],
                        ),
                      ),
                    ),
                  );
                },
              ),
            ],
          ),
        ),
      ),
    );
  }
}
